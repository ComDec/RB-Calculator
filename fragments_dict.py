smiles_rings={'C1CNCC1':(5,(0,1,2)),
              'C1NCC=C1':(5,(0,1,4)),
              'C1=CNCC1':(5,(0,1,2,3,4)),
              'C1N=CC=C1':(5,(0,2,3,4)),
              'C1=CNC=C1':(5,(0,1,2)),
              'C1CNNC1':(5,(0,1,2)),
              'C1NCNC1':(5,(0,1,2)),
              'C1C=NNC1':(5,(0,1,3,4)),
              'C1N=CNC1':(5,(0,2,3,4)),
              'C1=NNC=C1':(5,(0,2,3,4)),
              'C1=CNC=N1':(5,(2,)),
              'C1=NNC=N1':(5,(0,2,3)),
              'C1=CN=NN1':(5,(0,1,4)),
              'C1=NN=NN1':(5,(0,4)),
              
              'C1OCCC1':(5,(0,4)),
              'C1=COC=C1':(5,(0,1)),
              'C1OCCO1':(5,(2,)),
              'C1SCCC1':(5,(0,4)),
              'C1=CSC=C1':(5,(0,1)),
              'C1=CN=CO1':(5,(0,1)),
              'C1=CC=NO1':(5,(0,1,2)),
              'C1=CC=NS1':(5,(0,1,2)),
              'C1=CN=CS1':(5,(0,1)),
              'C1OSCC1':(5,(0,3,4)),
              'C1OCCS1':(5,(0,2,3)),
              'O1N=CC=N1':(5,(2,3)),
              'C1=CON=N1':(5,(0,1)),
              'S1N=CC=N1':(5,(2,)),
              
              'O=S1(=O)CCCC1':(7,(3,4)),
              'N1C(=O)CSC1(=O)':(7,(0,3)),
              'N1C(=O)CCC1(=O)':(7,(0,3)),
              'O=C1NCCO1':(6,(2,3,4)),
              'N1C(=O)CNC1(=O)':(7,(0,3,4)),
              
              'N1CCCCC1':(6,(0,1,2,3)),
              'N1=CC=CC=C1':(6,(1,2,3)),
              'N1CCNCC1':(6,(0,1)),
              'N1=CC=CC=N1':(6,(1,2)),
              'N1=CC=CN=C1':(6,(1,2)),
              'N1=CC=NC=C1':(6,(5,)),
              'N1=CC=NC=N1':(6,(1,2)),
              'O1CCCCC1':(6,(1,2,3)),
              'O1C=CC=CC1':(6,(1,2,3,4,5)),
              'O1C=CCC=C1':(6,(1,2,3)),
              'O1CCOCC1':(6,(1,)),
              'O1C=COC=C1':(6,(1,)),
              
              'S1CCCCC1':(6,(1,2,3)),
              'S1C=CC=CC1':(6,(1,2,3,4,5)),
              'S1C=CCC=C1':(6,(1,2,3)),
              'S1CCSCC1':(6,(1,)),
              'S1CCCSC1':(6,(1,2)),
              'O1CCNCC1':(6,(1,2,3)),
              'C1C=NOC=C1':(6,(0,1,4,5)),
              'C1=CNOC=C1':(6,(0,1,2,4,5)),
              'C1=CC=NOC1':(6,(0,1,2,5)),
              'C1N=COC=C1':(6,(0,4,5)),
              
              'S1CCNCC1':(6,(1,2,3)),
              'S1C=CNC=C1':(6,(1,2)),
              'S1NC=CC=C1':(6,(1,2,3,4,5)),
              'S1N=CC=CC1':(6,(2,3,4,5)),
              'S1CC=NC=C1':(6,(1,2,4,5)),
              'O=C1NC=CC(N)=N1':(8,(2,3,4)),
              'O=C1C=CNC(=O)N1':(8,(2,3,4,7)),
              'O=S1(=O)CCNCC1':(8,(3,4,5)),
              
              'C1CC2CCCN2C1':(8,(0,1,7)),
              'N1C=CC2=C1CCC2':(8,(0,1,2,5,6,7)),
              'N1C=CC2C1C=CN2':(8,(0,1,2)),
              'N1C=CC2=C1C=CN2':(8,(0,1,2)),
              'N1C=CC2=C1NC=C2':(8,(0,1,2)),
              'N1C=CC2=C1OC=C2':(8,(0,1,2,6,7)),
              'N1C=CC2=C1C=CO2':(8,(0,1,2,5,6)),
              'N1C=CC2=C1SC=C2':(8,(0,1,2,6,7)),
              'N1C=CC2=C1C=CS2':(8,(0,1,2,5,6)),
              
              'C1=CC=C2CCCC2=C1':(9,(1,2,4,5)),
              'C1=CC=C2CC=CC2=C1':(9,(0,1,2,4,5,6,8)),
              'C1=CC=C2CCNC2=C1':(9,(0,1,2,4,5,6,8)),
              'C1=CC=C2CC=NC2=C1':(9,(0,1,2,4,5,8)),
              'C1=CC=C2C=CNC2=C1':(9,(0,1,2,4,5,6,8)),
              'N1C=C2C=CC=CC2=C1':(9,(0,1,3,4)),
              'C1=CN2C=CC=CC2=C1':(9,(0,1,3,4,5,6,8)),
              'C1=CC=C2C=NNC2=C1':(9,(0,1,2,4,6,8)),
              'C1=CC=C2N=CNC2=C1':(9,(0,1,2,5,6,8)),
              'C1=CC=C2C=CNC2=N1':(9,(0,1,2,4,5,6)),
              'C1=CN=C2C=CNC2=C1':(9,(0,1,4,5,6,8)),
              'C1=NC=C2C=CNC2=C1':(9,(0,2,4,5,6,8)),
              'N1=CC=C2C=CNC2=C1':(9,(1,2,4,5,6,8)),
              
              'C1=CN=C2NN=CC2=C1':(9,(0,1,4,6,8)),
              'C1=CC=NC2=CC=NN21':(9,(0,1,2,5,6)),
              'N1C=NC2=NC=NC=C21':(9,(0,1,5,7)),
              'C1=CC=C2C=COC2=C1':(9,(0,1,2,4,5,8)),
              'C1=CC=CC2=COC=C21':(9,(2,3,5)),
              'C1=CC=CC2=CSC=C21':(9,(2,3,5)),
              'C1=CC=C2C=CSC2=C1':(9,(0,1,2,4,5,8)),
              
              'C1=CC=C2C=NOC2=C1':(9,(0,1,2,4,8)),
              'C1=CC=CC2=CON=C21':(9,(0,1,2,3,5)),
              'C1=CC=CC2=CSN=C21':(9,(0,1,2,3,5)),
              'C1=CC=C2C=NSC2=C1':(9,(0,1,2,4,8)),
              'C1=CC=C2N=COC2=C1':(9,(0,1,2,8)),
              'C1=CC=C2N=CSC2=C1':(9,(0,1,2,8)),
              'C1=CC=CC2=NSN=C21':(9,(2,3)),
              
              'O=C1NSC2=C1C=CC=C2':(10,(2,6,7,8,9)),
              'C1=NC(N)=C2NC=NC2=N1':(10,(0,5,6)),
              'N1=C(N)NC(=O)C2=C1NC=N2':(11,(3,8,9)),
              
              'C1CCCC2C1CCNC2':(10,(0,1,2,3,6,7,8,9)),
              'C1CCCC2C1CCCN2':(10,(0,1,2,3,6,7,8,9)),
              'C1=CC=CC2=C1CCCN2':(10,(0,1,2,3,6,7,8,9)),
              'C1=CC=C2NCC=CC2=C1':(10,(0,1,2,4,5,6,7,9)),
              'C1=CC=C2CNC=CC2=C1':(10,(0,1,2,4,5,6,7,9)),
              'C1=CC=C2N=CC=CC2=C1':(10,(0,1,2,5,6,7,9)),
              'C1=CC=CC2=C1C=CN=C2':(10,(0,1,2,3,6,7,9)),
              'C1=CC=CN2C1=CC=CC2':(10,(0,1,2,3,6,7,8,9)),
              
              'C1=CC=C2C=CC=CC2=C1':(10,(2,)),
              'C1=CC=C2N=CC=NC2=C1':(10,(1,2,5)),
              'C1=CC=CC2=C1C=NN=C2':(10,(0,1,6)),
              'C1=CC=CC2=NC=NC=C21':(10,(0,1,2,3,6,8)),
              'C1=CC=CC2=NN=CC=C21':(10,(0,1,2,3,7,8)),
              'C1=CN=C2N=CC=CC2=C1':(10,(0,1,5,6,7,9)),
              'C1=NC=C2N=CC=CC2=N1':(10,(0,2,5,6,7)),
              'C1=NC=C2C=NC=CC2=N1':(10,(0,2,4,6,7)),
              'C1=CN=C2C=NC=CC2=N1':(10,(0,1,4,6,7)),
              'C1=CN=C2N=CC=CC2=N1':(10,(0,1,5,6,7)),
              'N1=CC=NC2=NC=NC=C21':(10,(1,2,6,8)),
              
              'C1=CC=C2OCC=CC2=C1':(10,(0,1,2,5,6,7,9)),
              'C1=CC=C2COC=CC2=C1':(10,(0,1,2,4,6,7,9)),
              'C1=CC=CC2=COCC=C21':(10,(0,1,2,3,5,7,8)),
              'C1=CC=C2OC(=O)C=CC2=C1':(11,(0,1,2,7,8,10)),
              'C1=CC=C2ONC=CC2=C1':(10,(0,1,2,5,6,7,9)),
              'C1=CC=C2OCN=CC2=C1':(10,(0,1,2,5,7,9)),
              'C1=CC=C2OCC=NC2=C1':(10,(0,1,2,5,6,9)),
              'C1=CC=C2NC(=O)C=CC2=C1':(11,(0,1,2,4,7,8,10)),
              'C1=CC=C2C(=O)NC=CC2=C1':(11,(0,1,2,6,7,8,10)),
              
              'C1=CC=C2C=C3C=CC=CC3=CC2=C1':(14,(2,)),
              'C1C2=CC=CC=C2C3=CC=CC=C31':(13,(0,2,3)),
              'N1C2=CC=CC=C2C3=CC=CC=C31':(13,(0,2,3)),
              'O1C2=CC=CC=C2C3=CC=CC=C31':(13,(2,3)),
              'C1=CC=C2C(=C1)C=C3C=CC=CC3=N2':(14,(0,1,2,5,6)),
              'C1=CC=C2C(=C1)N=C3C=CC=CC3=N2':(14,(1,2)),
              'C1=CC=C2C(=C1)NC3=CC=CC=C3O2':(14,(0,1,2,5,6)),
              'C1=CC=C2C(=C1)NC3=CC=CC=C3S2':(14,(0,1,2,5,6)),
              'C1=CC=C2C(=C1)SC3=CC=CC=C3O2':(14,(0,1,2,5)),
                            
              
              'c1ccccc1':(6,(0,)),
              'C1C=CC2C1C(CN2)':(8,(5,)),
              'C1SCNCC1':(6,(3,)),
              'N1CSCC1':(5,(0,)),
              'C1=NC2=C(C=NN2)CN1':(9,(8,)),
              'C1=CCNCN1':(6,(1,)),
              'C1OC2=C(O1)C(=CC=C2)':(9,(5,)),
              'C1NCNN1':(5,(4,)),
              'C1=CCCCC1':(6,(0,)),
              'C1=NC2=CC=CC=C2CN1':(10,(9,6,3)),
              'N1CC2=C(CCS2)N=C1':(9,(0,)),
              'N1C=CCNC1':(6,(0,)),
              'N1C=CC=NC1':(6,(0,)),
              
              
              }

subunit_list = ["C12=CC=CC=C1C=C3C(C=CC=C3)=C2", "CC(C)C", "C12=CC=CC=C1C=CC=C2", "C1=CC=CC=C1", "C1(PC2=CC=CC=C2)=CC=CC=C1", 
                "CC(C=C1C)=CC=C1PC2=C(C)C=C(C)C=C2", "CC(C(OC)=C1C)=CC=C1PC2=C(C)C(OC)=C(C)C=C2", "CC(C(OC)=C1C)=CC=C1PC2=C(C)C(OC)=C(C)C=C2",
                "CC(C)C(C=C1)=C(OC)C(C(C)C)=C1PC2=CC=C(C(C)C)C(OC)=C2C(C)C", "CCCC(C(N(C)C)=C1CCC)=CC=C1PC2=C(CCC)C(N(C)C)=C(CCC)C=C2"]
index_list = [[4, 6, 12], [1], [4, 6], [0], [1], [8], [10], [10], [14], [15]]
subunit_dict = dict(zip(subunit_list, index_list))

group_list = ["C(=O)O", "CO", "CC(=O)C", "C=O", "C(=O)OC", "COC", "C=CC", "C#N", "C=NC", "CCl"]
index_list = [[0], [0], [0], [0], [3], [0], [2], [0], [0, 2], [0]]
group_dict = dict(zip(group_list, index_list))